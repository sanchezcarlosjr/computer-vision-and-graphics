---
layout: default
title:  "Exercise 5 - Sierpi≈Ñski triangle"
---
<style>
container {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
}

canvas {
	width: 100%;
	max-height: 50%;
	border: none;
	padding: 0;
	margin: 0;
}
</style>

<container>
 <canvas id="gl-canvas">Your browser does not seem to support HTML canvas.</canvas>
</container>

<script src="https://unpkg.com/rxjs@^7/dist/bundles/rxjs.umd.min.js"></script>
<script src="https://interactivecomputergraphics.com/Code/Common/initShaders.js"></script>
<script src="https://interactivecomputergraphics.com/Code/Common/MVnew.js"></script>

<script id="fragment-shader" type="x-shader/x-fragment">
 #version 300 es
 precision mediump float;
 out vec4 fColor;
 void main() {
     fColor = vec4(0.949,0.804,0.361,1.0);
 }
</script>
<script id="vertex-shader" type="x-shader/x-vertex">
 #version 300 es

 void main() {
    gl_Position = vec4(vec2(angle,sin(angle))*scale*0.3, 0, 1);
 }
</script>


<script>
	const { generate, take, scan, last } = rxjs;
	function white(black) {
		return [
			mult(0.5,add(black[0], black[1])),
			mult(0.5,add(black[0], black[2])),
			mult(0.5,add(black[1], black[2])),
		];
	}
	function blacks(black) {
		return [
			[
				black[0],
				mult(0.5,add(black[0], black[1])),
				mult(0.5,add(black[0], black[2]))
			],
			[
				mult(0.5,add(black[0], black[1])),
				black[1],
				mult(0.5,add(black[1], black[2]))
			],
			[
				mult(0.5,add(black[0], black[2])),
				mult(0.5,add(black[1], black[2])),
				black[2]
			]
		];
	}
	generate({
		initialState: {
			blacks: [[vec2(0,1),vec2(-1,-1),vec2(1,-1)]],
			whites: []
		},
		iterate: state => state.blacks.reduce((acc, triangle) => {
			// Each triangle has 1 hole and 3 sub triangles.
			acc.whites.push(white(triangle));
			acc.blacks.push(...blacks(triangle));
			return acc;
		}, {blacks: [], whites: []})
	}).pipe(take(3), scan((acc, curr) => [...acc,...curr.whites], []), last()).subscribe(console.log);
</script>
